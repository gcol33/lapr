<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Vignette Improvement Plan for couplr • couplr</title><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet"><meta property="og:title" content="Vignette Improvement Plan for couplr"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">couplr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="articles/getting-started.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/algorithms.html">Algorithm Details</a></li>
    <li><a class="dropdown-item" href="articles/matching-workflows.html">Matching Workflows</a></li>
    <li><a class="dropdown-item" href="articles/pixel-morphing.html">Pixel Morphing &amp; Scientific Applications</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="dropdown-item" href="news/index.html">Version 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gcol33/couplr" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vignette Improvement Plan for couplr</h1>
      <small class="dont-index">Source: <a href="https://github.com/gcol33/couplr/blob/HEAD/VIGNETTE_IMPROVEMENT_PLAN.md" class="external-link"><code>VIGNETTE_IMPROVEMENT_PLAN.md</code></a></small>
    </div>

<div id="vignette-improvement-plan-for-couplr" class="section level1">

<div class="section level2">
<h2 id="executive-summary">Executive Summary<a class="anchor" aria-label="anchor" href="#executive-summary"></a></h2>
<p>This document outlines a comprehensive plan to address the structural, narrative, and meta-explanatory weaknesses identified in the four couplr vignettes. The improvements focus on:</p>
<ol style="list-style-type: decimal"><li>
<strong>Unified documentation ecosystem</strong> with cross-references and consistent structure</li>
<li>
<strong>Shared example dataset</strong> that recurs across vignettes</li>
<li>
<strong>Explicit audience guidance</strong> and difficulty indicators</li>
<li>
<strong>Progressive narrative flow</strong> from concept to example to interpretation</li>
<li><strong>Discussion of limitations, edge cases, and failure modes</strong></li>
<li>
<strong>Clear positioning</strong> of the package in the R ecosystem</li>
</ol><hr></div>
<div class="section level2">
<h2 id="cross-cutting-improvements-all-vignettes">Cross-Cutting Improvements (All Vignettes)<a class="anchor" aria-label="anchor" href="#cross-cutting-improvements-all-vignettes"></a></h2>
<div class="section level3">
<h3 id="id_1-create-a-unified-introduction-section">1. Create a Unified Introduction Section<a class="anchor" aria-label="anchor" href="#id_1-create-a-unified-introduction-section"></a></h3>
<p>Add a consistent introductory block to each vignette that:</p>
<ul><li>States the purpose and target audience</li>
<li>Positions the vignette within the documentation ecosystem</li>
<li>Provides difficulty/prerequisite indicators</li>
<li>Links to related vignettes</li>
</ul><p><strong>Template to add at the start of each vignette (after Overview):</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">### Who This Vignette Is For</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>**Audience**: <span class="co">[</span><span class="ot">Beginners | Intermediate users | Advanced users / Algorithm developers</span><span class="co">]</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>**Prerequisites**:</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">List any required vignettes or knowledge</span><span class="co">]</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">e.g., "Basic R knowledge", "Familiarity with matching concepts"</span><span class="co">]</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>**What You'll Learn**:</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">3-5 specific takeaways</span><span class="co">]</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>**Time to Complete**: <span class="co">[</span><span class="ot">Approximate reading/working time</span><span class="co">]</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">### Documentation Roadmap</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>The couplr documentation is organized as follows:</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="pp">|</span> Vignette <span class="pp">|</span> Focus <span class="pp">|</span> Difficulty <span class="pp">|</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="pp">|----------|-------|------------|</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a><span class="pp">|</span> **Getting Started** <span class="pp">|</span> Basic LAP solving, API introduction <span class="pp">|</span> Beginner <span class="pp">|</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="pp">|</span> **Algorithms** <span class="pp">|</span> Mathematical foundations, solver selection <span class="pp">|</span> Intermediate <span class="pp">|</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="pp">|</span> **Matching Workflows** <span class="pp">|</span> Production matching pipelines <span class="pp">|</span> Intermediate <span class="pp">|</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="pp">|</span> **Pixel Morphing** <span class="pp">|</span> Scientific applications, approximations <span class="pp">|</span> Advanced <span class="pp">|</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>*You are here: [Current vignette]*</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-introduce-a-shared-example-dataset">2. Introduce a Shared Example Dataset<a class="anchor" aria-label="anchor" href="#id_2-introduce-a-shared-example-dataset"></a></h3>
<p>Create a recurring dataset that appears across all vignettes, establishing coherence:</p>
<p><strong>Proposal</strong>: “Hospital Staff Scheduling” dataset</p>
<ul><li>
<strong>Basic form</strong> (getting-started): 10 nurses × 10 shifts, simple cost matrix</li>
<li>
<strong>Extended form</strong> (algorithms): Same problem with different cost structures to demonstrate algorithm differences</li>
<li>
<strong>Matching form</strong> (matching-workflows): 200 nurses needing to be matched with 300 controls for a study</li>
<li>
<strong>Large-scale form</strong> (pixel-morphing): Analogy to visual matching, demonstrate when approximations are needed</li>
</ul><p><strong>Implementation</strong>: Add to <code>data/</code> as <code>hospital_example</code> with documentation in <code>R/data.R</code></p>
</div>
<div class="section level3">
<h3 id="id_3-add-limitations-and-edge-cases-sections">3. Add “Limitations and Edge Cases” Sections<a class="anchor" aria-label="anchor" href="#id_3-add-limitations-and-edge-cases-sections"></a></h3>
<p>Each vignette should include a dedicated section discussing:</p>
<ul><li>When the method breaks down</li>
<li>Common failure modes</li>
<li>Performance bottlenecks</li>
<li>Infeasibility conditions</li>
<li>Numerical issues</li>
</ul></div>
<div class="section level3">
<h3 id="id_4-establish-narrative-transitions">4. Establish Narrative Transitions<a class="anchor" aria-label="anchor" href="#id_4-establish-narrative-transitions"></a></h3>
<p>Add explicit transition paragraphs between major sections that:</p>
<ul><li>Summarize what was just covered</li>
<li>Preview what comes next</li>
<li>Explain <em>why</em> the transition makes sense</li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="vignette-specific-improvements">Vignette-Specific Improvements<a class="anchor" aria-label="anchor" href="#vignette-specific-improvements"></a></h2>
<hr></div>
<div class="section level2">
<h2 id="id_1-getting-started-getting-startedrmd">1. Getting Started (getting-started.Rmd)<a class="anchor" aria-label="anchor" href="#id_1-getting-started-getting-startedrmd"></a></h2>
<div class="section level3">
<h3 id="current-state">Current State<a class="anchor" aria-label="anchor" href="#current-state"></a></h3>
<ul><li>394 lines</li>
<li>Jumps directly into examples</li>
<li>Good technical content but reads like reference documentation</li>
<li>Missing orientation and positioning</li>
</ul></div>
<div class="section level3">
<h3 id="improvements">Improvements<a class="anchor" aria-label="anchor" href="#improvements"></a></h3>
<div class="section level4">
<h4 id="a-add-explicit-orientation-new-section-after-line-22">A. Add Explicit Orientation (New Section After Line 22)<a class="anchor" aria-label="anchor" href="#a-add-explicit-orientation-new-section-after-line-22"></a></h4>
<p><strong>Insert after “## Overview”:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">### Why couplr?</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>The linear assignment problem (LAP) appears throughout data science, operations research, and scientific computing. While other R packages address LAP (see Comparison below), couplr distinguishes itself through:</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="ss">1. </span>**Tidy integration**: First-class support for tibbles, dplyr workflows, and grouped data</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="ss">2. </span>**Algorithm selection**: 12+ algorithms with automatic selection based on problem structure</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="ss">3. </span>**Production matching**: High-level matching functions for observational studies (v1.0.0)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="ss">4. </span>**Visual applications**: Pixel morphing and transport visualization</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>**Alternative packages**:</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="ss">- </span><span class="in">`clue`</span>: General purpose optimization (LAP is one feature among many)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="ss">- </span><span class="in">`lpSolve`</span>: Linear programming focus, less specialized for assignment</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="ss">- </span><span class="in">`RcppHungarian`</span>: Single algorithm, no tidy interface</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>couplr focuses specifically on assignment problems with a user-friendly API and modern R idioms.</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">### Who This Vignette Is For</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>**Audience**: Beginners to couplr, R users familiar with basic matrix operations</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>**Prerequisites**:</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="ss">- </span>Basic R knowledge (data frames, functions)</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="ss">- </span>Understanding of what a "cost" or "distance" matrix means</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>**What You'll Learn**:</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="ss">- </span>How to solve basic assignment problems with <span class="in">`lap_solve()`</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="ss">- </span>Working with data frames, rectangular problems, and forbidden assignments</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="ss">- </span>Batch solving and finding multiple solutions</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="ss">- </span>When to use different algorithms</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>**Time to Complete**: 20-30 minutes</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="b-add-narrative-frame-follow-one-problem-through">B. Add Narrative Frame: Follow One Problem Through<a class="anchor" aria-label="anchor" href="#b-add-narrative-frame-follow-one-problem-through"></a></h4>
<p>Restructure the vignette around a single problem that evolves:</p>
<ol style="list-style-type: decimal"><li>
<strong>Introduction</strong>: Hospital shift scheduling (simple 3×3)</li>
<li>
<strong>Data frame input</strong>: Same problem from a database</li>
<li>
<strong>Rectangular</strong>: More shifts than nurses</li>
<li>
<strong>Forbidden</strong>: Some nurses can’t work certain shifts</li>
<li>
<strong>Maximization</strong>: Preference scores instead of costs</li>
<li>
<strong>Batch</strong>: Multiple days of scheduling</li>
<li>
<strong>K-best</strong>: Alternative schedules for flexibility</li>
</ol><p><strong>Modification to existing content</strong>: Keep the current examples but frame them as variations of the hospital problem. Add narrative transitions like:</p>
<blockquote>
<p>“Now that we can solve the basic problem, what happens when we have more shifts than nurses to fill them?”</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="c-add-common-pitfalls-section-before-summary">C. Add “Common Pitfalls” Section (Before Summary)<a class="anchor" aria-label="anchor" href="#c-add-common-pitfalls-section-before-summary"></a></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">## Common Pitfalls and Troubleshooting</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">### Problem: "All assignments have Inf cost"</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>**Cause**: Too many forbidden entries (NA/Inf) make the problem infeasible.</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>**Solution**: Check that a feasible solution exists. For rectangular problems with forbidden entries, ensure at least one valid assignment exists for each source.</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># Check feasibility</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>feasible <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(<span class="fu">is.finite</span>(cost)) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(feasible)) {</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">"Sources "</span>, <span class="fu">which</span>(<span class="sc">!</span>feasible), <span class="st">" have no valid targets"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="problem-unexpected-assignments">Problem: Unexpected assignments<a class="anchor" aria-label="anchor" href="#problem-unexpected-assignments"></a></h3>
<p><strong>Cause</strong>: Cost matrix orientation wrong (rows vs columns swapped).</p>
<p><strong>Solution</strong>: Remember: rows = sources, columns = targets. The result <code>match</code> vector has length = nrow, and <code>match[i]</code> is the column assigned to row i.</p>
</div>
<div class="section level3">
<h3 id="problem-different-results-with-different-methods">Problem: Different results with different methods<a class="anchor" aria-label="anchor" href="#problem-different-results-with-different-methods"></a></h3>
<p><strong>Cause</strong>: Multiple optimal solutions may exist. Different algorithms may find different optima with the same total cost.</p>
<p><strong>Solution</strong>: If you need deterministic results, set a seed or use <code>method = "hungarian"</code> which has deterministic tie-breaking.</p>
</div>
<div class="section level3">
<h3 id="problem-slow-performance-on-large-problems">Problem: Slow performance on large problems<a class="anchor" aria-label="anchor" href="#problem-slow-performance-on-large-problems"></a></h3>
<p><strong>Cause</strong>: O(n³) complexity for exact algorithms.</p>
<p><strong>Solution</strong>: - For n &gt; 1000: Consider <code>method = "auction"</code> - For n &gt; 5000: Use blocking or greedy matching (<code><a href="articles/matching-workflows.html">vignette("matching-workflows")</a></code>) - For n &gt; 10000: Use approximation strategies (<code><a href="articles/pixel-morphing.html">vignette("pixel-morphing")</a></code>)</p>
<pre><code>
#### D. Improve Section Transitions

Add transition paragraphs. Example between "Basic Usage" and "Working with Rectangular Problems":

&gt; "The examples above assumed equal numbers of sources and targets. But real-world problems rarely have this symmetry—a hospital may have 20 nurses but need to cover 30 shifts, or have 50 tasks but only budget for 40 workers. couplr handles these rectangular problems automatically."

---

## 2. Algorithms (algorithms.Rmd)

### Current State
- 667 lines
- Good mathematical content
- Stays at intuitive level, lacks formal structure
- No explicit comparison between algorithms
- No failure modes discussed

### Improvements

#### A. Add Structured Algorithm Template

Restructure each algorithm section to follow a consistent pattern:

```markdown
### [Algorithm Name]

**Complexity**: [Big-O notation]

**When to Use**:
- [Bullet points of ideal conditions]

**When NOT to Use**:
- [Bullet points of poor conditions]

#### Core Idea

[1-2 paragraph intuitive explanation]

#### Formal Description

[Mathematical formulation with LaTeX]

**Input**: [Describe input requirements]

**Output**: [Describe output guarantees]

**Algorithm Steps**:
1. [Numbered steps with mathematical notation]

#### Implementation Notes

[Practical considerations, numerical issues]

#### Example

[Code demonstrating the algorithm]

#### Failure Modes and Edge Cases

- [When the algorithm may fail or perform poorly]
- [Numerical stability concerns]
- [Special cases to watch for]</code></pre>
<div class="section level4">
<h4 id="b-add-comparative-analysis-section">B. Add Comparative Analysis Section<a class="anchor" aria-label="anchor" href="#b-add-comparative-analysis-section"></a></h4>
<p><strong>Insert after “## Algorithms in couplr” (around line 68):</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">### Algorithm Selection Guide</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>Before diving into individual algorithms, here's a decision framework:</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>                Is the cost matrix <span class="fu">binary</span> (<span class="dv">0</span><span class="sc">/</span><span class="dv">1</span>)?</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                          <span class="sc">|</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>          ┌───────────────┴───────────────┐</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>          Yes                             No</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>          <span class="sc">|</span>                               <span class="er">|</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>      Use HK01                    Is sparsity <span class="sc">&gt;</span> <span class="dv">50</span>%?</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                                          <span class="sc">|</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                          ┌───────────────┴───────────────┐</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                          Yes                             No</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                          <span class="sc">|</span>                               <span class="er">|</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>                      Use SAP                      Is n <span class="sc">&gt;</span> <span class="dv">1000</span>?</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                                                          <span class="sc">|</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>                                          ┌───────────────┴───────────────┐</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>                                          Yes                             No</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>                                          <span class="sc">|</span>                               <span class="er">|</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>                                      Use Auction              Use <span class="fu">JV</span> (default)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>                                      or consider</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>                                      approximations</span></code></pre></div>
<pre><code>
### Head-to-Head Comparisons

| Scenario | Hungarian | JV | Auction | SAP | HK01 |
|----------|-----------|----|---------|----|------|
| Dense 100×100 | ✓✓✓ | ✓✓✓ | ✓✓ | ✓ | N/A |
| Dense 1000×1000 | ✓ | ✓✓✓ | ✓✓✓ | ✓ | N/A |
| Sparse 80% forbidden | ✓ | ✓✓ | ✓ | ✓✓✓ | N/A |
| Binary costs | ✓ | ✓ | ✓ | ✓ | ✓✓✓ |
| Rectangular n×2n | ✗ | ✓✓ | ✗ | ✓✓✓ | ✓✓ |
| Numerical precision | ✓✓✓ | ✓✓ | ✓ | ✓✓ | ✓✓✓ |

✓✓✓ = Excellent, ✓✓ = Good, ✓ = Acceptable, ✗ = Not recommended</code></pre>
</div>
<div class="section level4">
<h4 id="c-add-limitations-and-numerical-issues-section">C. Add “Limitations and Numerical Issues” Section<a class="anchor" aria-label="anchor" href="#c-add-limitations-and-numerical-issues-section"></a></h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">## Limitations and Numerical Issues</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">### When LAP Algorithms Fail</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>**1. Infeasible Problems**</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>If too many entries are forbidden (NA/Inf), no valid assignment may exist:</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># Infeasible: no column reachable from row 2</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">Inf</span>, <span class="cn">Inf</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># lap_solve(cost) will error or return partial solution</span></span></code></pre></div>
<p><strong>Detection</strong>: Check <code>rowSums(is.finite(cost)) &gt; 0</code> for all rows.</p>
<p><strong>2. Nearly Degenerate Problems</strong></p>
<p>When many costs are nearly equal, small numerical errors can cause: - Different algorithms finding different solutions - Cycling in auction algorithms - Incorrect optimality certification</p>
<p><strong>Mitigation</strong>: Use <code>method = "hungarian"</code> for maximum numerical stability, or add small random perturbations.</p>
<p><strong>3. Overflow in Dual Variables</strong></p>
<p>For very large cost ranges (&gt; 10^10), dual variable updates may overflow:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Problematic: cost range is 10^15</span></span>
<span><span class="va">cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-5</span>, <span class="fl">1e10</span>, <span class="fl">1e10</span>, <span class="fl">1e-5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><strong>Mitigation</strong>: Scale costs to a reasonable range (0 to 10^6) before solving.</p>
</div>
</div>
<div class="section level3">
<h3 id="algorithm-specific-issues">Algorithm-Specific Issues<a class="anchor" aria-label="anchor" href="#algorithm-specific-issues"></a></h3>
<table class="table"><thead><tr><th>Algorithm</th>
<th>Known Issues</th>
<th>Mitigation</th>
</tr></thead><tbody><tr><td>Hungarian</td>
<td>Slow for n &gt; 500</td>
<td>Use JV or Auction</td>
</tr><tr><td>JV</td>
<td>May cycle with ties</td>
<td>Use tie-breaking epsilon</td>
</tr><tr><td>Auction</td>
<td>Slow convergence for small epsilon</td>
<td>Use scaled variant</td>
</tr><tr><td>SAP</td>
<td>Inefficient for dense problems</td>
<td>Use JV instead</td>
</tr><tr><td>HK01</td>
<td>Only for binary costs</td>
<td>Not applicable otherwise</td>
</tr></tbody></table><pre><code>
#### D. Add Conceptual Diagram Section

**Insert after Formal Definition (around line 45):**

```markdown
### Visualizing the Assignment Problem

**Bipartite Graph Representation**

Imagine the LAP as a weighted bipartite graph:
</code></pre>
<p>Sources (rows) Targets (columns)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>S₁ ───────<span class="dv">2</span>──────── T₁</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a> │ ╲     ╱         ╱│</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a> │  ╲<span class="dv">4</span>  ╱<span class="dv">3</span>        ╱ │</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a> <span class="dv">3</span>   ╲ ╱        <span class="dv">5</span>   <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a> │    ╳          ╱  │</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a> │   ╱ ╲       ╱    │</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>S₂ ─╱───╲──<span class="dv">1</span>──╱──── T₂</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>   ╱     ╲   ╱     ╱</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>  ╱       ╲ ╱    <span class="dv">2</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>S₃ ────<span class="dv">3</span>───╳───── T₃</span></code></pre></div>
<p>Edge weights = costs Goal: Select one edge per source, one per target, minimizing total weight</p>
<pre><code>
**Complementary Slackness Intuition**

At optimality, think of dual variables as "prices":
- $u_i$ = how much source $i$ is willing to pay
- $v_j$ = how much target $j$ is worth

An assignment $(i,j)$ is used only if $u_i + v_j = c_{ij}$ (price equals cost).</code></pre>
<hr></div>
</div>
<div class="section level2">
<h2 id="id_3-matching-workflows-matching-workflowsrmd">3. Matching Workflows (matching-workflows.Rmd)<a class="anchor" aria-label="anchor" href="#id_3-matching-workflows-matching-workflowsrmd"></a></h2>
<div class="section level3">
<h3 id="current-state-1">Current State<a class="anchor" aria-label="anchor" href="#current-state-1"></a></h3>
<ul><li>1134 lines (longest vignette)</li>
<li>Applied and concrete</li>
<li>Reads like isolated steps rather than cohesive journey</li>
<li>Missing interpretation guidance and pitfall discussion</li>
<li>Good real-world example at end but comes late</li>
</ul></div>
<div class="section level3">
<h3 id="improvements-1">Improvements<a class="anchor" aria-label="anchor" href="#improvements-1"></a></h3>
<div class="section level4">
<h4 id="a-move-real-world-example-earlier">A. Move Real-World Example Earlier<a class="anchor" aria-label="anchor" href="#a-move-real-world-example-earlier"></a></h4>
<p>Restructure to follow the real-world example throughout:</p>
<ol style="list-style-type: decimal"><li>
<strong>Introduction</strong>: Present the job training evaluation scenario</li>
<li>
<strong>Basic matching</strong>: First attempt with <code><a href="reference/match_couples.html">match_couples()</a></code>
</li>
<li>
<strong>Preprocessing</strong>: Why we need <code>auto_scale = TRUE</code>
</li>
<li>
<strong>Balance assessment</strong>: Is our match good enough?</li>
<li>
<strong>Refinements</strong>: Adding calipers, trying greedy</li>
<li>
<strong>Publication output</strong>: Tables and effect estimates</li>
</ol><p>This makes the vignette a narrative journey rather than a feature catalog.</p>
</div>
<div class="section level4">
<h4 id="b-add-what-can-go-wrong-section">B. Add “What Can Go Wrong” Section<a class="anchor" aria-label="anchor" href="#b-add-what-can-go-wrong-section"></a></h4>
<p><strong>Insert after “## Automatic Preprocessing” (around line 189):</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">### What Can Go Wrong</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">#### 1. Poor Match Quality Despite Convergence</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>**Symptom**: <span class="in">`match_couples()`</span> completes but balance diagnostics show |std diff| &gt; 0.25.</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>**Causes**:</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="ss">- </span>Fundamental differences between groups that matching cannot overcome</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="ss">- </span>Important confounders not included in matching variables</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="ss">- </span>Caliper too loose</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>**Solutions**:</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="ss">- </span>Add more matching variables</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="ss">- </span>Tighten caliper (accept fewer matches)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="ss">- </span>Consider different estimand (ATT vs ATE)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="ss">- </span>Report sensitivity analysis</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="fu">#### 2. Few or No Matches</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>**Symptom**: <span class="in">`n_matched`</span> is much smaller than expected.</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>**Causes**:</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="ss">- </span>Caliper too strict</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="ss">- </span>Non-overlapping support (groups truly different)</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="ss">- </span>Blocking variables create small strata</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a>**Diagnosis**:</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co"># Check overlap</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">bind_rows</span>(left, right), <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><strong>Solutions</strong>: - Relax caliper - Use coarser blocking - Consider propensity score matching with wider bands</p>
</div>
<div class="section level4">
<h4 id="id_3-imbalanced-but-optimal">3. Imbalanced but Optimal<a class="anchor" aria-label="anchor" href="#id_3-imbalanced-but-optimal"></a></h4>
<p><strong>Symptom</strong>: Optimal matching completes but balance is worse than greedy.</p>
<p><strong>Reality</strong>: Optimal minimizes <em>total distance</em>, not balance metrics. A globally optimal solution may sacrifice balance on one variable to gain on another.</p>
<p><strong>Solutions</strong>: - Try greedy matching (may find different local optimum) - Add explicit balance constraints (future feature) - Use matching with replacement (different estimand)</p>
</div>
<div class="section level4">
<h4 id="id_4-computational-issues">4. Computational Issues<a class="anchor" aria-label="anchor" href="#id_4-computational-issues"></a></h4>
<p><strong>Symptom</strong>: <code><a href="reference/match_couples.html">match_couples()</a></code> takes &gt; 1 minute or crashes.</p>
<p><strong>Causes</strong>: - n &gt; 5000 for optimal matching - Full cost matrix doesn’t fit in memory</p>
<p><strong>Solutions</strong>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For n &gt; 5000: use greedy</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greedy_couples.html">greedy_couples</a></span><span class="op">(</span><span class="va">left</span>, <span class="va">right</span>, vars <span class="op">=</span> <span class="va">vars</span>, strategy <span class="op">=</span> <span class="st">"sorted"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For n &gt; 10000: use blocking</span></span>
<span><span class="va">blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/matchmaker.html">matchmaker</a></span><span class="op">(</span><span class="va">left</span>, <span class="va">right</span>, block_type <span class="op">=</span> <span class="st">"cluster"</span>, n_blocks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/match_couples.html">match_couples</a></span><span class="op">(</span><span class="va">blocks</span><span class="op">$</span><span class="va">left</span>, <span class="va">blocks</span><span class="op">$</span><span class="va">right</span>, vars <span class="op">=</span> <span class="va">vars</span>, block_id <span class="op">=</span> <span class="st">"block_id"</span><span class="op">)</span></span></code></pre></div>
<pre><code>
#### C. Add Interpretation Guidance Throughout

After each balance diagnostic output, add interpretation:

```markdown
### Interpreting Balance Results

```r
print(balance)
#&gt; Balance Diagnostics
#&gt; -------------------
#&gt; Variables: age, income, education
#&gt;
#&gt; Variable Statistics:
#&gt;   variable mean_left mean_right std_diff var_ratio ks_stat ks_p
#&gt;   age      45.2      45.8       -0.08    0.95      0.06    0.89
#&gt;   income   58000     56500      0.12     1.08      0.09    0.45
#&gt;   education 2.1      2.0        0.15     0.98      0.08    0.62</code></pre>
<p><strong>How to read this</strong>:</p>
<table class="table"><colgroup><col width="25%"><col width="22%"><col width="51%"></colgroup><thead><tr><th>Metric</th>
<th>Value</th>
<th>Interpretation</th>
</tr></thead><tbody><tr><td>std_diff</td>
<td>-0.08 for age</td>
<td>Excellent (&lt;0.1), means differ by 0.08 pooled SDs</td>
</tr><tr><td>std_diff</td>
<td>0.12 for income</td>
<td>Good (0.1-0.25), minor imbalance acceptable</td>
</tr><tr><td>var_ratio</td>
<td>0.95-1.08</td>
<td>All close to 1.0, spread is similar</td>
</tr><tr><td>ks_p</td>
<td>&gt; 0.05 for all</td>
<td>Distributions not significantly different</td>
</tr></tbody></table><p><strong>Overall assessment</strong>: This is a well-balanced match. Proceed with analysis.</p>
<p><strong>If balance were poor</strong> (|std_diff| &gt; 0.25): 1. Check for outliers in the problematic variable 2. Consider adding the variable to blocking 3. Tighten caliper 4. Report and discuss in limitations</p>
<pre><code>
#### D. Add Section Transitions

Example transition after "Basic Usage":

&gt; "We've created our first matched sample, but how do we know it's any good? A match that pairs units with wildly different characteristics defeats the purpose. In the next section, we examine how automatic preprocessing prevents common data problems from degrading match quality."

---

## 4. Pixel Morphing (pixel-morphing.Rmd)

### Current State
- 884 lines
- Excellent pedagogical intent
- Conceptually rich but jumps between intuition and application
- Purpose not fully clear (teach intuition? show feature? provide motivation?)
- No connection to practical workflows

### Improvements

#### A. Clarify Purpose Upfront

**Replace current Overview with:**

```markdown
## Overview

This vignette serves three purposes:

1. **Visual intuition**: Use image morphing to build intuition for assignment problems. Pixels are entities, colors are features, positions are spatial coordinates—a direct analog to scientific matching.

2. **Scalability strategies**: Demonstrate three approximation approaches when exact LAP becomes infeasible (n &gt; 1000).

3. **Scientific applications**: Show how the same algorithms apply to ecology, physics, and chemistry.

**This vignette is unusual**: Unlike the other couplr documentation, it emphasizes *understanding* over *doing*. If you're looking to solve a matching problem, start with `vignette("getting-started")` or `vignette("matching-workflows")`. Come here when you want to understand *why* these algorithms work and *when* approximations are appropriate.

### Who This Vignette Is For

**Audience**: Advanced users, researchers, algorithm developers

**Prerequisites**:
- Familiarity with `lap_solve()` (`vignette("getting-started")`)
- Basic understanding of complexity (Big-O notation)
- Interest in algorithm design or scientific applications

**What You'll Learn**:
- Why exact LAP becomes infeasible for large n
- Three approximation strategies and their trade-offs
- How matching problems appear in ecology, physics, and chemistry
- Mathematical connections to optimal transport theory

**Time to Complete**: 45-60 minutes (conceptual reading)</code></pre>
</div>
<div class="section level4">
<h4 id="b-add-explicit-conceptual-scaffolding">B. Add Explicit Conceptual Scaffolding<a class="anchor" aria-label="anchor" href="#b-add-explicit-conceptual-scaffolding"></a></h4>
<p><strong>Insert after Overview, before “The General Matching Problem”:</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">## How This Vignette Is Organized</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>We follow a specific arc:</span></code></pre></div>
<p>Exact Solution Approximation Strategies Applications (Foundation) (When exact fails) (Real-world) │ │ │ ▼ ▼ ▼ What is the 1. Feature quantization Ecology: plots matching problem? 2. Hierarchical decomp. Physics: particles │ 3. Resolution reduction Chemistry: atoms │ │ │ ▼ ▼ ▼ Visual demo: Visual comparison Pseudocode for pixel morphing of approximations each domain</p>
<pre><code>
**Key insight**: The pixel morph is not just decoration—it's a computational testbed. Each pixel is an entity with features (color) and position, making the abstract matching problem concrete and visual.</code></pre>
</div>
<div class="section level4">
<h4 id="c-add-connection-to-workflows-section">C. Add “Connection to Workflows” Section<a class="anchor" aria-label="anchor" href="#c-add-connection-to-workflows-section"></a></h4>
<p><strong>Insert before Summary:</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">## Connection to couplr Workflows</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">### When Do These Strategies Apply?</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>The approximation strategies in this vignette become relevant in couplr's matching functions:</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="pp">|</span> Strategy <span class="pp">|</span> couplr Implementation <span class="pp">|</span> When to Use <span class="pp">|</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="pp">|----------|----------------------|-------------|</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="pp">|</span> Exact LAP <span class="pp">|</span> <span class="in">`match_couples(method = "hungarian")`</span> <span class="pp">|</span> n &lt; 3000 <span class="pp">|</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="pp">|</span> Feature quantization <span class="pp">|</span> Implicit in <span class="in">`scale = "robust"`</span> <span class="pp">|</span> Reduces effective feature space <span class="pp">|</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="pp">|</span> Hierarchical <span class="pp">|</span> <span class="in">`matchmaker(block_type = "cluster")`</span> <span class="pp">|</span> n &gt; 3000, use blocking <span class="pp">|</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="pp">|</span> Resolution reduction <span class="pp">|</span> Future feature <span class="pp">|</span> Very large n <span class="pp">|</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="fu">### Practical Recommendations</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>**For n &lt; 3000**: Use <span class="in">`match_couples()`</span> with exact algorithms. Runtime is seconds.</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>**For 3000 &lt; n &lt; 10000**:</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co"># Use blocking to create smaller subproblems</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="fu">matchmaker</span>(left, right, <span class="at">block_type =</span> <span class="st">"cluster"</span>, <span class="at">n_blocks =</span> <span class="dv">10</span>)</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">match_couples</span>(blocks<span class="sc">$</span>left, blocks<span class="sc">$</span>right, vars, <span class="at">block_id =</span> <span class="st">"block_id"</span>)</span></code></pre></div>
<p><strong>For n &gt; 10000</strong>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use greedy matching</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greedy_couples.html">greedy_couples</a></span><span class="op">(</span><span class="va">left</span>, <span class="va">right</span>, <span class="va">vars</span>, strategy <span class="op">=</span> <span class="st">"sorted"</span><span class="op">)</span></span></code></pre></div>
<p><strong>For n &gt; 50000</strong>: Consider the approximation strategies in this vignette, implemented via custom code using <code><a href="reference/lap_solve.html">lap_solve()</a></code> on subproblems.</p>
<pre><code>
#### D. Add Limitations Section

```markdown
## Limitations of Approximation Strategies

### Feature Quantization

**Works well when**: Features cluster naturally into distinct groups (e.g., vegetation types, particle species, atom types).

**Fails when**:
- Feature space is continuous with no natural clusters
- Important distinctions exist within clusters
- Spatial structure doesn't align with feature groups

**Artifacts**: Band-like motion, loss of individual trajectories, discrete jumps.

### Hierarchical Decomposition

**Works well when**: Spatial locality is meaningful (nearby entities should match nearby).

**Fails when**:
- Optimal matches cross spatial boundaries (e.g., long-distance particle transport)
- Patch boundaries cut through important structures
- Hierarchy depth is mismatched to problem structure

**Artifacts**: Boundary discontinuities, suboptimal cross-region matches.

### Resolution Reduction

**Works well when**: Coarse structure is sufficient, fine detail is noise.

**Fails when**:
- Fine-grained structure matters (individual atom positions, exact pixel colors)
- Upscaling introduces ambiguity

**Artifacts**: Blocky results, non-bijective mappings (multiple fine entities per coarse cell).</code></pre>
<hr></div>
</div>
</div>
<div class="section level2">
<h2 id="implementation-checklist">Implementation Checklist<a class="anchor" aria-label="anchor" href="#implementation-checklist"></a></h2>
<div class="section level3">
<h3 id="phase-1-cross-cutting-do-first">Phase 1: Cross-Cutting (Do First)<a class="anchor" aria-label="anchor" href="#phase-1-cross-cutting-do-first"></a></h3>
<ul class="task-list"><li><label><input type="checkbox">Create shared example dataset (<code>hospital_example</code>)</label></li>
<li><label><input type="checkbox">Write standard documentation roadmap block</label></li>
<li><label><input type="checkbox">Create transition paragraph templates</label></li>
</ul></div>
<div class="section level3">
<h3 id="phase-2-getting-started">Phase 2: Getting Started<a class="anchor" aria-label="anchor" href="#phase-2-getting-started"></a></h3>
<ul class="task-list"><li><label><input type="checkbox">Add orientation paragraph (why couplr, positioning)</label></li>
<li><label><input type="checkbox">Add “Who This Vignette Is For” block</label></li>
<li><label><input type="checkbox">Restructure around hospital scheduling narrative</label></li>
<li><label><input type="checkbox">Add “Common Pitfalls” section</label></li>
<li><label><input type="checkbox">Add section transitions</label></li>
<li><label><input type="checkbox">Review and improve cross-references</label></li>
</ul></div>
<div class="section level3">
<h3 id="phase-3-algorithms">Phase 3: Algorithms<a class="anchor" aria-label="anchor" href="#phase-3-algorithms"></a></h3>
<ul class="task-list"><li><label><input type="checkbox">Apply structured algorithm template to each algorithm</label></li>
<li><label><input type="checkbox">Add comparative analysis section with decision tree</label></li>
<li><label><input type="checkbox">Add “Limitations and Numerical Issues” section</label></li>
<li><label><input type="checkbox">Add conceptual diagram (bipartite graph)</label></li>
<li><label><input type="checkbox">Add algorithm-specific failure modes</label></li>
<li><label><input type="checkbox">Improve cross-references</label></li>
</ul></div>
<div class="section level3">
<h3 id="phase-4-matching-workflows">Phase 4: Matching Workflows<a class="anchor" aria-label="anchor" href="#phase-4-matching-workflows"></a></h3>
<ul class="task-list"><li><label><input type="checkbox">Restructure to follow job training example throughout</label></li>
<li><label><input type="checkbox">Add “What Can Go Wrong” section</label></li>
<li><label><input type="checkbox">Add interpretation guidance after each diagnostic</label></li>
<li><label><input type="checkbox">Add section transitions</label></li>
<li><label><input type="checkbox">Shorten/consolidate redundant sections</label></li>
<li><label><input type="checkbox">Improve cross-references</label></li>
</ul></div>
<div class="section level3">
<h3 id="phase-5-pixel-morphing">Phase 5: Pixel Morphing<a class="anchor" aria-label="anchor" href="#phase-5-pixel-morphing"></a></h3>
<ul class="task-list"><li><label><input type="checkbox">Clarify purpose in Overview</label></li>
<li><label><input type="checkbox">Add conceptual scaffolding diagram</label></li>
<li><label><input type="checkbox">Add “Connection to Workflows” section</label></li>
<li><label><input type="checkbox">Add limitations of approximation strategies</label></li>
<li><label><input type="checkbox">Improve cross-references</label></li>
</ul></div>
<div class="section level3">
<h3 id="phase-6-final-integration">Phase 6: Final Integration<a class="anchor" aria-label="anchor" href="#phase-6-final-integration"></a></h3>
<ul class="task-list"><li><label><input type="checkbox">Verify all cross-references work</label></li>
<li><label><input type="checkbox">Check shared dataset is used consistently</label></li>
<li><label><input type="checkbox">Build vignettes and verify rendering</label></li>
<li><label><input type="checkbox">Review narrative flow across all vignettes</label></li>
<li><label><input type="checkbox">Final copyedit pass</label></li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="estimated-effort">Estimated Effort<a class="anchor" aria-label="anchor" href="#estimated-effort"></a></h2>
<table class="table"><thead><tr><th>Vignette</th>
<th>Current Lines</th>
<th>Estimated Change</th>
<th>Effort</th>
</tr></thead><tbody><tr><td>Getting Started</td>
<td>394</td>
<td>+100-150 lines</td>
<td>Medium</td>
</tr><tr><td>Algorithms</td>
<td>667</td>
<td>+150-200 lines</td>
<td>High</td>
</tr><tr><td>Matching Workflows</td>
<td>1134</td>
<td>+50-100 lines (restructure)</td>
<td>High</td>
</tr><tr><td>Pixel Morphing</td>
<td>884</td>
<td>+100-150 lines</td>
<td>Medium</td>
</tr><tr><td>Shared dataset</td>
<td>N/A</td>
<td>New file</td>
<td>Low</td>
</tr></tbody></table><p><strong>Total estimated effort</strong>: 3-5 focused work sessions</p>
<hr></div>
<div class="section level2">
<h2 id="success-criteria">Success Criteria<a class="anchor" aria-label="anchor" href="#success-criteria"></a></h2>
<p>After improvements, each vignette should:</p>
<ol style="list-style-type: decimal"><li>
<strong>Clearly state</strong> who it’s for and what they’ll learn</li>
<li>
<strong>Position itself</strong> within the documentation ecosystem</li>
<li>
<strong>Follow a narrative</strong> that builds logically</li>
<li>
<strong>Provide interpretation</strong> not just mechanics</li>
<li>
<strong>Discuss limitations</strong> honestly</li>
<li>
<strong>Cross-reference</strong> related vignettes appropriately</li>
<li>
<strong>Use the shared dataset</strong> where appropriate for coherence</li>
</ol><p>The documentation as a whole should feel like chapters of a book rather than independent reference documents.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

