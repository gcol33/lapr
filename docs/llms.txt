# couplr

[![R-CMD-check](https://img.shields.io/badge/R--CMD--check-passing-brightgreen)](https://github.com/gcol33/couplr)
[![License:
MIT](https://img.shields.io/badge/License-MIT-blue.svg)](https://opensource.org/licenses/MIT)

**couplr** is an R package for solving Linear Assignment Problems (LAP)
with production-ready matching workflows. It provides optimal one-to-one
matching between two groups, with automatic preprocessing, balance
diagnostics, and analysis-ready output.

## Installation

``` r

# Install from GitHub
remotes::install_github("gcol33/couplr")
```

## Quick Start

``` r

library(couplr)

# Match treatment and control groups on covariates
result <- match_couples(
 treated, control,
 vars = c("age", "income", "education"),
 auto_scale = TRUE
)

# Check covariate balance
balance_diagnostics(result, treated, control, vars = c("age", "income", "education"))

# Get analysis-ready dataset
matched_data <- join_matched(result, treated, control)
```

## Features

- **12 optimal LAP algorithms**: Hungarian, Jonker-Volgenant, Auction,
  Gabow-Tarjan, and more
- **3 greedy algorithms**: Fast approximate matching for large datasets
- **Automatic preprocessing**: Variable scaling, health checks,
  categorical encoding
- **Balance diagnostics**: Standardized differences, variance ratios, KS
  statistics
- **Blocking support**: Exact matching and stratification
- **Distance caching**: Precompute distances for rapid experimentation
- **Parallel processing**: Multi-core matching via the future framework

## Usage

### Optimal Matching

``` r

result <- match_couples(
 left = treated,
 right = control,
 vars = c("age", "income"),
 auto_scale = TRUE,
 max_distance = 0.5
)
```

### Greedy Matching (Large Datasets)

``` r

result <- greedy_couples(
 left = treated,
 right = control,
 vars = c("age", "income"),
 strategy = "row_best"
)
```

### Low-Level LAP Solving

``` r

cost <- matrix(c(4, 2, 8, 4, 3, 7, 3, 1, 6), nrow = 3, byrow = TRUE)
result <- lap_solve(cost)
```

## Documentation

- [`vignette("getting-started", package = "couplr")`](https://gcol33.github.io/couplr/articles/getting-started.md)
- [`vignette("algorithms", package = "couplr")`](https://gcol33.github.io/couplr/articles/algorithms.md)
- [`vignette("matching-workflows", package = "couplr")`](https://gcol33.github.io/couplr/articles/matching-workflows.md)
- [`vignette("pixel-morphing", package = "couplr")`](https://gcol33.github.io/couplr/articles/pixel-morphing.md)

## Citation

``` bibtex
@software{couplr,
 author = {Colling, Gilles},
 title = {couplr: Optimal Matching via Linear Assignment},
 year = {2025},
 url = {https://github.com/gcol33/couplr}
}
```

## License

MIT

# Package index

## LAP Solving

Core functions for solving linear assignment problems

- [`lap_solve()`](https://gcol33.github.io/couplr/reference/lap_solve.md)
  : Solve linear assignment problems
- [`lap_solve_batch()`](https://gcol33.github.io/couplr/reference/lap_solve_batch.md)
  : Solve multiple assignment problems efficiently
- [`lap_solve_kbest()`](https://gcol33.github.io/couplr/reference/lap_solve_kbest.md)
  : Find k-best optimal assignments
- [`lap_solve_line_metric()`](https://gcol33.github.io/couplr/reference/lap_solve_line_metric.md)
  : Solve 1-D Line Assignment Problem
- [`assignment()`](https://gcol33.github.io/couplr/reference/assignment.md)
  : Linear assignment solver

## Matching Functions

High-level matching for observational studies

- [`match_couples()`](https://gcol33.github.io/couplr/reference/match_couples.md)
  : Optimal matching using linear assignment
- [`greedy_couples()`](https://gcol33.github.io/couplr/reference/greedy_couples.md)
  : Fast approximate matching using greedy algorithm
- [`matchmaker()`](https://gcol33.github.io/couplr/reference/matchmaker.md)
  : Create blocks for stratified matching

## Balance Diagnostics

Assess and report match quality

- [`balance_diagnostics()`](https://gcol33.github.io/couplr/reference/balance_diagnostics.md)
  : Balance Diagnostics for Matched Pairs
- [`balance_table()`](https://gcol33.github.io/couplr/reference/balance_table.md)
  : Create Balance Table

## Distance and Preprocessing

Distance computation and data preparation

- [`compute_distances()`](https://gcol33.github.io/couplr/reference/compute_distances.md)
  : Compute and Cache Distance Matrix for Reuse
- [`update_constraints()`](https://gcol33.github.io/couplr/reference/update_constraints.md)
  : Update Constraints on Distance Object
- [`preprocess_matching_vars()`](https://gcol33.github.io/couplr/reference/preprocess_matching_vars.md)
  : Preprocess matching variables with automatic checks and scaling
- [`diagnose_distance_matrix()`](https://gcol33.github.io/couplr/reference/diagnose_distance_matrix.md)
  : Diagnose distance matrix and suggest fixes

## Joined Datasets

Create analysis-ready merged datasets

- [`join_matched()`](https://gcol33.github.io/couplr/reference/join_matched.md)
  : Join Matched Pairs with Original Data
- [`augment(`*`<matching_result>`*`)`](https://gcol33.github.io/couplr/reference/augment.matching_result.md)
  : Augment Matching Results with Original Data (broom-style)
- [`augment()`](https://gcol33.github.io/couplr/reference/augment.md) :
  Generic Augment Function

## Utility Functions

Helper functions for working with results

- [`get_total_cost()`](https://gcol33.github.io/couplr/reference/get_total_cost.md)
  : Extract total cost from assignment result
- [`get_method_used()`](https://gcol33.github.io/couplr/reference/get_method_used.md)
  : Extract method used from assignment result
- [`as_assignment_matrix()`](https://gcol33.github.io/couplr/reference/as_assignment_matrix.md)
  : Convert assignment result to a binary matrix
- [`is_lap_solve_result()`](https://gcol33.github.io/couplr/reference/is_lap_solve_result.md)
  : Check if object is an assignment result
- [`is_lap_solve_batch_result()`](https://gcol33.github.io/couplr/reference/is_lap_solve_batch_result.md)
  : Check if object is a batch assignment result
- [`is_lap_solve_kbest_result()`](https://gcol33.github.io/couplr/reference/is_lap_solve_kbest_result.md)
  : Check if object is a k-best assignment result
- [`is_distance_object()`](https://gcol33.github.io/couplr/reference/is_distance_object.md)
  : Check if Object is a Distance Object

## Example Data

Built-in datasets for examples and testing

- [`hospital_staff`](https://gcol33.github.io/couplr/reference/hospital_staff.md)
  : Hospital staff scheduling example dataset
- [`example_costs`](https://gcol33.github.io/couplr/reference/example_costs.md)
  : Example cost matrices for assignment problems
- [`example_df`](https://gcol33.github.io/couplr/reference/example_df.md)
  : Example assignment problem data frame

## Pixel Morphing

Visual demonstrations and image processing

- [`pixel_morph()`](https://gcol33.github.io/couplr/reference/pixel_morph.md)
  : Pixel-level image morphing (final frame only)
- [`pixel_morph_animate()`](https://gcol33.github.io/couplr/reference/pixel_morph_animate.md)
  : Pixel-level image morphing (animation)

## Print and Summary Methods

S3 methods for displaying results

- [`print(`*`<lap_solve_result>`*`)`](https://gcol33.github.io/couplr/reference/print.lap_solve_result.md)
  : Print method for assignment results
- [`print(`*`<lap_solve_batch_result>`*`)`](https://gcol33.github.io/couplr/reference/print.lap_solve_batch_result.md)
  : Print method for batch assignment results
- [`print(`*`<lap_solve_kbest_result>`*`)`](https://gcol33.github.io/couplr/reference/print.lap_solve_kbest_result.md)
  : Print method for k-best assignment results
- [`print(`*`<matching_result>`*`)`](https://gcol33.github.io/couplr/reference/print.matching_result.md)
  : Print method for matching results
- [`print(`*`<matchmaker_result>`*`)`](https://gcol33.github.io/couplr/reference/print.matchmaker_result.md)
  : Print method for matchmaker results
- [`print(`*`<balance_diagnostics>`*`)`](https://gcol33.github.io/couplr/reference/print.balance_diagnostics.md)
  : Print Method for Balance Diagnostics
- [`print(`*`<distance_object>`*`)`](https://gcol33.github.io/couplr/reference/print.distance_object.md)
  : Print Method for Distance Objects
- [`print(`*`<preprocessing_result>`*`)`](https://gcol33.github.io/couplr/reference/print.preprocessing_result.md)
  : Print method for preprocessing result
- [`print(`*`<variable_health>`*`)`](https://gcol33.github.io/couplr/reference/print.variable_health.md)
  : Print method for variable health
- [`summary(`*`<lap_solve_kbest_result>`*`)`](https://gcol33.github.io/couplr/reference/summary.lap_solve_kbest_result.md)
  : Get summary of k-best results
- [`summary(`*`<distance_object>`*`)`](https://gcol33.github.io/couplr/reference/summary.distance_object.md)
  : Summary Method for Distance Objects

# Articles

### Getting Started

- [Quick
  Start](https://gcol33.github.io/couplr/articles/getting-started.md):

### Deep Dives

- [Theory and
  Algorithms](https://gcol33.github.io/couplr/articles/algorithms.md):
- [Matching
  Workflows](https://gcol33.github.io/couplr/articles/matching-workflows.md):
- [Advanced
  Topics](https://gcol33.github.io/couplr/articles/pixel-morphing.md):
